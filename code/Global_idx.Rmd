---
title: "Índices Generales"
author: "Ariel Fuentes"
date:  "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    theme: simplex
    highlight: tango
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
```

### Introducción

En este reporte se entregará el resumen general de los Indicadores que se encuentra en Estudio de modo de saber el comportamiento de la red.

## Superposición

Este indicador permite visualizar la superposición de cada servicio con respecto al resto de recorridos a nivel de periodo, las superposición es en base a un área de influencia de 300 metros.

````{r, message=FALSE, echo=FALSE, fig.align='center'}
#general
spp_dfGL %>%
  ggplot(aes(x=UN, 
             y=idx_spp)
  ) + 
  geom_violin(color="black", fill = "lightblue")  +
  labs(x = "Unidad 6",
       y = "índice de superposición", 
       fill = "tipo de día") +
  annotate("text", 
           x = 6, 
           y = 2, 
           label =  paste("Promedio:",
                          round(mean(spp_dfGL$idx_spp), digits = 2))
           ) +
  annotate("text", 
           x = 6, 
           y = 1.5, 
           label =  paste("Dev. Est.:",
                          round(sd(spp_dfGL$idx_spp), digits = 2))
  ) +
  theme(axis.text.x = element_blank()) +
  ggtitle("Superposición Global")
#by day
spp_tdia %>% 
  ggplot(aes(x=factor(tipo_dia, levels = c("LABORAL", "SABADO", "DOMINGO")), 
             y=idx_spp,
             fill=tipo_dia
  )
  ) + 
  geom_violin() +
  labs(x = "tipo de dia", 
       y = "índice de superposición", 
       fill = "tipo de día") +
  geom_text(aes(x=factor(tipo_dia, levels = c("LABORAL", "SABADO", "DOMINGO")), 
                y=c(2.5, 2.5, 2.5),
                label=paste("Promedio:", round(promedio, 2))), 
            data = filter(spp_tdia, pos1 == 0)) +
  geom_text(aes(x=factor(tipo_dia, levels = c("LABORAL", "SABADO", "DOMINGO")), 
                y=c(1, 1, 1),
                label=paste("Desv. Est.:", round(`Dev. Est.`, 2))), 
            data = filter(spp_tdia, pos2 == 0)) +
  ggtitle("Superposición por Tipo de día")
#by period
spp_per %>%
  ggplot(aes(x=periodo_n, 
             y=idx_spp,
             fill = periodo)
  ) + 
  geom_violin(show.legend = F)  +
  scale_x_continuous(breaks = round(seq(min(spp_tdia$periodo_n), 
                                        max(spp_tdia$periodo_n), 
                                        by = 1),
                                    0)
                     ) +
  geom_text(aes(x=periodo_n, 
                y=rep(2, 29),
                label=paste("P.:", round(promedio, 1)
                            )
                ), 
            size = 3,
            data = filter(spp_per, is.na(pos1))
            ) +
  geom_text(aes(x=periodo_n,
                y=rep(1, 29),
                label=paste("D.E.:", round(`Dev. Est.`, 1)
                            )
                ),
            size = 3,
            data = filter(spp_per, is.na(pos2))
            ) +
  facet_wrap("tipo_dia", scales = "free", nrow = 3) +
  labs(x = "periodos", 
       y = "índice de superposición", 
       fill = "periodo") +
  ggtitle("Superposición por Periodo")
````

En base a los gráficos presentados, se demuestra que el comportamiento de uso no es estable a lo largo de distintos periodos/días; pero delínea donde enfatizar nuestros esfuerzos.
